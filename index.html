<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gates of Olympus 1000 - Clone</title>
    <style>
        body {
            background-color: #1a0b2e;
            color: white;
            font-family: sans-serif;
            text-align: center;
            margin: 0;
            overflow: hidden;
        }
        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: url('image/background.png') no-repeat center center;
            background-size: cover;
        }
        /* Fallback background if image missing */
        #game-container.no-bg {
            background: radial-gradient(circle, #4a1c40 0%, #000000 100%);
        }

        #grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 5px;
            width: 80%;
            max-width: 600px;
            aspect-ratio: 6/5;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid gold;
            padding: 10px;
            border-radius: 10px;
        }
        .symbol {
            width: 100%;
            height: 100%;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            text-shadow: 0 0 5px black;
        }
        /* Placeholder styling for symbols until we map real images */
        .sym-0 { color: #aaa; } /* Gem Blue */
        .sym-1 { color: #0f0; } /* Gem Green */
        .sym-2 { color: #ff0; } /* Gem Yellow */
        .sym-3 { color: #f0f; } /* Gem Purple */
        .sym-4 { color: #f00; } /* Gem Red */
        .sym-5 { color: gold; } /* Chalice */
        .sym-6 { color: pink; } /* Ring */
        .sym-7 { color: orange; } /* Hourglass */
        .sym-8 { color: cyan; } /* Crown */
        .sym-9 { color: white; font-weight: bold; text-shadow: 0 0 10px gold;} /* Zeus Scatter */

        #controls {
            margin-top: 20px;
            z-index: 10;
        }
        button {
            padding: 15px 40px;
            font-size: 24px;
            background: linear-gradient(to bottom, #ffeb3b, #fbc02d);
            border: 2px solid #fff;
            border-radius: 50px;
            cursor: pointer;
            color: #3e2723;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transition: transform 0.1s;
        }
        button:active {
            transform: scale(0.95);
        }
        button:disabled {
            filter: grayscale(1);
            cursor: not-allowed;
        }
        #win-display {
            font-size: 32px;
            color: gold;
            text-shadow: 0 0 10px orange;
            min-height: 40px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div id="game-container" class="no-bg">
    <div id="win-display">Win: 0.00</div>
    <div id="grid">
        <!-- Cells will be injected here -->
    </div>
    <div id="controls">
        <button id="spin-btn">SPIN</button>
    </div>
</div>

<script>
    const gridEl = document.getElementById('grid');
    const spinBtn = document.getElementById('spin-btn');
    const winDisplay = document.getElementById('win-display');

    // Mappings for available images in 'image/' to symbols
    // Based on filenames seen in `ls image/` output, most are UUIDs.
    // Since I don't know exactly which UUID corresponds to which symbol,
    // I will try to use the `oneworks_logo.png` or other identified ones if possible,
    // but likely I have to rely on placeholder text or try to load them blindly.
    // Ideally, we would have renamed them.
    // For now, I will use CSS classes .sym-X to style them with colors/text.
    // If you identify specific images, update this array.
    const symbolImages = {};

    // Initial Empty Grid
    for(let i=0; i<30; i++) {
        const cell = document.createElement('div');
        cell.className = 'symbol';
        gridEl.appendChild(cell);
    }

    spinBtn.addEventListener('click', async () => {
        spinBtn.disabled = true;
        winDisplay.innerText = "Spinning...";

        try {
            const res = await fetch('/.netlify/functions/spin');
            const data = await res.json();

            renderGrid(data.grid);

            if (data.win > 0) {
                winDisplay.innerText = `WIN: ${data.win.toFixed(2)}`;
                // Animate win (simple flash)
                gridEl.style.borderColor = 'white';
                setTimeout(() => gridEl.style.borderColor = 'gold', 500);
            } else {
                winDisplay.innerText = "Good Luck!";
            }
        } catch (e) {
            console.error("Spin failed", e);
            winDisplay.innerText = "Error!";
        }

        spinBtn.disabled = false;
    });

    function renderGrid(symbols) {
        gridEl.innerHTML = '';
        symbols.forEach(sym => {
            const cell = document.createElement('div');
            cell.className = `symbol sym-${sym}`;
            cell.innerText = getSymbolChar(sym); // Fallback to text/emoji

            // If we had image mapping:
            // if(symbolImages[sym]) cell.style.backgroundImage = `url('image/${symbolImages[sym]}')`;

            gridEl.appendChild(cell);
        });
    }

    function getSymbolChar(id) {
        const map = {
            0: 'üî∑', 1: 'üü©', 2: 'üî∫', 3: 'üíú', 4: 'üî¥',
            5: 'üèÜ', 6: 'üíç', 7: '‚è≥', 8: 'üëë', 9: '‚ö°'
        };
        return map[id] || '?';
    }
</script>

</body>
</html>
